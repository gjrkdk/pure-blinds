---
phase: 14-polish-url-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/confirmation/page.tsx
  - next.config.mjs
  - src/components/layout/breadcrumbs.tsx
autonomous: true

must_haves:
  truths:
    - "Visiting /confirmation renders the order confirmation page"
    - "Visiting /thank-you redirects (308) to /confirmation"
    - "Query parameters are preserved through redirect (/thank-you?order_id=X → /confirmation?order_id=X)"
    - "Breadcrumb links have adequate touch targets on mobile (WCAG 2.5.8)"
    - "Long breadcrumb labels truncate with ellipsis on mobile and show full text on hover"
  artifacts:
    - path: "src/app/confirmation/page.tsx"
      provides: "Order confirmation page at /confirmation URL"
      contains: "ConfirmationPage"
    - path: "next.config.mjs"
      provides: "Permanent redirect from /thank-you to /confirmation"
      contains: "/thank-you"
    - path: "src/components/layout/breadcrumbs.tsx"
      provides: "Responsive breadcrumbs with touch targets and truncation"
      contains: "py-3"
  key_links:
    - from: "next.config.mjs"
      to: "/confirmation"
      via: "redirects() async function"
      pattern: "source.*thank-you.*destination.*confirmation"
    - from: "src/app/confirmation/page.tsx"
      to: "/"
      via: "Back to home Link"
      pattern: "href=\"/\""
---

<objective>
Rename the thank-you page to confirmation with a permanent redirect and enhance breadcrumbs with responsive mobile styling.

Purpose: Complete the v1.2 milestone by migrating `/thank-you` to `/confirmation` for cleaner URLs and improving breadcrumb accessibility with WCAG 2.5.8 touch targets and mobile-friendly truncation.

Output: Confirmation page at `/confirmation`, 308 redirect from `/thank-you`, responsive breadcrumbs across all pages.
</objective>

<execution_context>
@/Users/robinkonijnendijk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/robinkonijnendijk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-polish-url-migration/14-RESEARCH.md
@src/components/layout/breadcrumbs.tsx
@next.config.mjs
@src/app/thank-you/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename thank-you page to confirmation and add 308 redirect</name>
  <files>src/app/confirmation/page.tsx, next.config.mjs</files>
  <action>
1. Move the directory: `mv src/app/thank-you src/app/confirmation`

2. In `src/app/confirmation/page.tsx`, rename the function from `ThankYouPage` to `ConfirmationPage`. No other content changes needed — the H1 "Thank you for your order" is user-facing copy and stays as-is.

3. Update `next.config.mjs` to add a redirects() function to the nextConfig object. Add the permanent redirect from `/thank-you` to `/confirmation`:

```javascript
const nextConfig = {
  async redirects() {
    return [
      {
        source: '/thank-you',
        destination: '/confirmation',
        permanent: true, // 308 status code, treated as 301 by Google
      },
    ]
  },
}
```

Keep the existing Velite build logic below the config object unchanged.

4. Verify the old directory `src/app/thank-you/` no longer exists.
  </action>
  <verify>
Run `ls src/app/confirmation/page.tsx` to confirm file exists at new path.
Run `ls src/app/thank-you/` to confirm old directory is removed (should error).
Run `grep -q "ConfirmationPage" src/app/confirmation/page.tsx && echo "OK"` to confirm function renamed.
Run `grep -q "thank-you" next.config.mjs && echo "OK"` to confirm redirect is configured.
Run `npx next build 2>&1 | tail -20` to verify build succeeds with redirect and new route.
  </verify>
  <done>
`/confirmation` route exists with ConfirmationPage function. `next.config.mjs` contains permanent redirect from `/thank-you` to `/confirmation`. Old `thank-you/` directory deleted. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Enhance breadcrumbs with responsive styling and WCAG touch targets</name>
  <files>src/components/layout/breadcrumbs.tsx</files>
  <action>
Update the Breadcrumbs component in `src/components/layout/breadcrumbs.tsx` with these responsive enhancements (per 14-RESEARCH.md patterns):

1. **Responsive gap spacing on `<ol>`**: Change `gap-2` to `gap-1.5 sm:gap-2` for compact mobile, comfortable desktop. Add `flex-wrap` to allow wrapping on very small screens.

2. **List item `min-w-0`**: Add `min-w-0` to each `<li>` so flex children can shrink below content size. Also update `<li>` gap to `gap-1.5 sm:gap-2` to match the `<ol>`.

3. **WCAG 2.5.8 touch targets on links**: Add `py-3` to the Link className for 44px touch target height on mobile. The full className becomes: `py-3 transition-colors hover:text-foreground truncate max-w-[150px] sm:max-w-none`.

4. **Text truncation on links**: Add `truncate max-w-[150px] sm:max-w-none` to Link className. Add `title={item.label}` attribute for full text on hover.

5. **Text truncation on current page span**: Add `truncate max-w-[200px] sm:max-w-none` to the `aria-current="page"` span className. Add `title={item.label}` attribute.

6. **Separator flex-none**: Add `flex-none` to the separator `<span>` className to prevent shrinking when text truncates.

The final component should match the enhanced example in 14-RESEARCH.md (Pattern 4: Mobile Breadcrumb Text Truncation).
  </action>
  <verify>
Run `grep -c "py-3" src/components/layout/breadcrumbs.tsx` to confirm touch target padding exists.
Run `grep -c "truncate" src/components/layout/breadcrumbs.tsx` to confirm truncation classes exist (should be 2 — link and span).
Run `grep -c "flex-none" src/components/layout/breadcrumbs.tsx` to confirm separator won't shrink.
Run `grep -c "min-w-0" src/components/layout/breadcrumbs.tsx` to confirm flex children can shrink.
Run `grep -c "title=" src/components/layout/breadcrumbs.tsx` to confirm title attributes exist (should be 2).
Run `grep -c "flex-wrap" src/components/layout/breadcrumbs.tsx` to confirm wrapping enabled.
Run `npx next build 2>&1 | tail -5` to verify build still passes.
  </verify>
  <done>
Breadcrumbs component has: `py-3` on links for WCAG 2.5.8 touch targets, `truncate` with responsive `max-w-*` on both links and current page, `title` attributes for hover text, `flex-none` on separators, `min-w-0` on list items, `flex-wrap` on container, responsive `gap-1.5 sm:gap-2` spacing. Build passes. All pages using breadcrumbs (products, categories, blog, product detail) get the enhancements automatically since they import the shared component.
  </done>
</task>

</tasks>

<verification>
1. Build succeeds: `npx next build` completes without errors
2. Route `/confirmation` exists in build output
3. Redirect `/thank-you` → `/confirmation` configured in next.config.mjs
4. Breadcrumbs enhanced with responsive patterns (touch targets, truncation, wrapping)
5. No references to old ThankYouPage function name remain in source
</verification>

<success_criteria>
- `/confirmation` route renders the order confirmation page
- `/thank-you` permanently redirects (308) to `/confirmation` with query params preserved
- Breadcrumbs have WCAG 2.5.8 compliant touch targets (py-3 = ~44px)
- Long breadcrumb labels truncate on mobile with title hover text
- Build passes with zero errors
</success_criteria>

<output>
After completion, create `.planning/phases/14-polish-url-migration/14-01-SUMMARY.md`
</output>
