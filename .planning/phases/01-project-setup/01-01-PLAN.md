---
phase: 01-project-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - src/lib/env.ts
  - data/pricing-matrix.json
  - .env.example
  - .env.local
  - .gitignore
  - src/app/layout.tsx
  - src/app/page.tsx
autonomous: true

must_haves:
  truths:
    - "npm run dev starts Next.js on localhost:3000 without errors"
    - "TypeScript compiles with zero errors (npm run build succeeds)"
    - "Pricing matrix JSON contains 20x20 grid (400 price points) in integer cents"
    - "Environment variable validation fails fast with clear error if vars missing"
  artifacts:
    - path: "src/lib/env.ts"
      provides: "Zod-validated environment variables"
      contains: "z.object"
    - path: "data/pricing-matrix.json"
      provides: "20x20 pricing matrix"
      contains: "priceUnit"
    - path: ".env.example"
      provides: "Template for required env vars"
      contains: "SHOPIFY_STORE_DOMAIN"
    - path: "package.json"
      provides: "Project dependencies"
      contains: "@shopify/shopify-api"
  key_links:
    - from: "src/lib/env.ts"
      to: "process.env"
      via: "Zod parse at module load"
      pattern: "envSchema\\.parse\\(process\\.env\\)"
---

<objective>
Initialize the Next.js project with TypeScript, install all dependencies, create environment variable validation, and add the pricing matrix data file.

Purpose: Establishes the complete project foundation that all subsequent phases build on. Without a working Next.js app, validated env vars, and pricing data, nothing else can proceed.
Output: A running Next.js 15+ application with TypeScript, Zod env validation, pricing matrix JSON, and all project dependencies installed.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-project-setup/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js project with dependencies</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    .gitignore
    .env.example
    .env.local
    src/app/layout.tsx
    src/app/page.tsx
  </files>
  <action>
    1. Run `npx create-next-app@latest . --yes --typescript --app --src-dir` in the project root to scaffold Next.js 15+ with App Router, TypeScript, Tailwind, and ESLint. Use `--src-dir` to put app code under `src/`. If the directory is not empty, use a temp directory and move files.

    2. Install project dependencies:
       ```
       npm install @shopify/shopify-api zod
       ```

    3. Create `.env.example` with placeholder values (committed to git):
       ```
       SHOPIFY_STORE_DOMAIN=your-store.myshopify.com
       SHOPIFY_ADMIN_ACCESS_TOKEN=shpat_your_admin_api_token
       SHOPIFY_API_VERSION=2026-01
       ```

    4. Create `.env.local` with the same keys but dummy values for now (so env validation does not crash during dev before real credentials exist):
       ```
       SHOPIFY_STORE_DOMAIN=placeholder.myshopify.com
       SHOPIFY_ADMIN_ACCESS_TOKEN=shpat_placeholder_token
       SHOPIFY_API_VERSION=2026-01
       ```

    5. Verify `.env.local` is in `.gitignore` (create-next-app includes it by default). If not, add it.

    6. Update `src/app/page.tsx` to a minimal homepage that confirms the app is running (simple heading: "Custom Textile Shop" with a subtitle "Development environment ready").

    DO NOT use Pages Router. App Router only (app/ directory under src/).
    DO NOT add NEXT_PUBLIC_ prefix to any Shopify credentials - they are server-only.
  </action>
  <verify>
    Run `npm run dev` and confirm localhost:3000 loads without errors.
    Run `npm run build` and confirm TypeScript compiles with zero errors.
    Verify `.env.local` is gitignored: `git check-ignore .env.local` outputs the path.
  </verify>
  <done>
    Next.js 15+ app runs locally on port 3000 with TypeScript, App Router, and all dependencies installed. .env.example committed, .env.local gitignored.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create env validation and pricing matrix</name>
  <files>
    src/lib/env.ts
    data/pricing-matrix.json
  </files>
  <action>
    1. Create `src/lib/env.ts` with Zod schema validation:
       - Schema validates: SHOPIFY_STORE_DOMAIN (string, min 1), SHOPIFY_ADMIN_ACCESS_TOKEN (string, min 1), SHOPIFY_API_VERSION (string, defaults to "2026-01"), NODE_ENV (enum: development/production/test, defaults to "development")
       - Parse process.env on module load (fail fast)
       - Export the validated env object as default export
       - Export the schema type for reuse: `export type Env = z.infer<typeof envSchema>`

    2. Create `data/pricing-matrix.json` with the full 20x20 pricing grid from the research document:
       - Include metadata: version "1.0.0", lastUpdated, description, currency "USD", priceUnit "cents"
       - Include dimensions config: width {min: 10, max: 200, step: 10, unit: "cm"}, height same
       - Include full 20x20 matrix array (all 20 rows from research, 400 integer cent values)
       - Row 0 = height 10cm (widths 10-200cm): [1000, 1200, ... 4800]
       - Row 19 = height 200cm (widths 10-200cm): [4800, 5000, ... 8600]
       - All values are integers representing cents (no floats)

    DO NOT use parseFloat or floating-point for any price values.
    DO NOT put the matrix file under src/ - it goes in project root `data/` directory.
  </action>
  <verify>
    Run `npm run build` to confirm env.ts compiles.
    Verify pricing matrix has exactly 20 rows and each row has exactly 20 values:
    `node -e "const m = require('./data/pricing-matrix.json'); console.log('rows:', m.matrix.length, 'cols:', m.matrix[0].length); console.log('all integers:', m.matrix.flat().every(v => Number.isInteger(v)))"`
    Expected output: rows: 20 cols: 20, all integers: true
  </verify>
  <done>
    Environment validation module exists at src/lib/env.ts with Zod schema. Pricing matrix JSON at data/pricing-matrix.json contains exactly 400 integer cent values in a 20x20 grid covering 10-200cm in both dimensions.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` starts without errors on localhost:3000
2. `npm run build` completes with zero TypeScript errors
3. Pricing matrix has 20 rows x 20 columns of integer cents
4. `.env.local` is gitignored
5. `@shopify/shopify-api` and `zod` are in package.json dependencies
</verification>

<success_criteria>
- Next.js 15+ app runs locally with TypeScript and App Router
- All dependencies installed (@shopify/shopify-api, zod)
- Environment validation with Zod exists and works
- Pricing matrix JSON file has 20x20 integer cents data
- .env.example committed, .env.local gitignored with placeholder values
</success_criteria>

<output>
After completion, create `.planning/phases/01-project-setup/01-01-SUMMARY.md`
</output>
